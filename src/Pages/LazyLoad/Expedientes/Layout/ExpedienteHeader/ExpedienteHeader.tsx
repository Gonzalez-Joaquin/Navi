import { useState } from 'react'
import { Tabs } from '../../../../../Components'
import Search from '../../../../../Components/Search/Search'
import { useAppSelector } from '../../../../../Hooks/useRedux'
import styles from './ExpedienteHeader.module.css'

const ExpedienteHeader = () => {
  const { fileTypes } = useAppSelector(state => state.metaData)
  const { statuses } = useAppSelector(state => state.metaData)
  const [filters, setFilters] = useState<Array<string>>([])
  const [isOpen, setIsOpen] = useState<boolean>(false)

  const onChangeFilter = (param: string) => {
    if (filters.includes(param)) {
      return setFilters(filters.filter(i => i !== param))
    }
    return setFilters([...filters, param])
  }

  const toggleFilter = () => setIsOpen(!isOpen)

  return (
    <article className={styles.header}>
      <Tabs tabs={statuses} />
      <div className={styles.search}>
        <Search name="records-search" />
        <div className={`${styles.container} ${isOpen ? styles.active : ''}`}>
          <button className={styles['filter-header']} type="button" onClick={() => toggleFilter()}>
            <span>Filtros:</span>
            {filters.length !== 0 && <p> {filters.length}</p>}
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M16.2917 10.0433H11.0833C11.0833 10.3254 10.9802 10.5695 10.7741 10.7757C10.5679 10.9819 10.3238 11.085 10.0417 11.085H7.95832C7.66535 11.085 7.4185 10.9819 7.21776 10.7757C7.01703 10.5695 6.91666 10.3254 6.91666 10.0433H1.70832C1.41535 10.0433 1.1685 9.94021 0.967763 9.73404C0.767025 9.52788 0.666656 9.28103 0.666656 8.99348C0.666656 8.70594 0.767025 8.4618 0.967763 8.26106C1.1685 8.06032 1.41535 7.95996 1.70832 7.95996H6.91666C6.91666 7.66699 7.01703 7.42013 7.21776 7.2194C7.4185 7.01866 7.66535 6.91829 7.95832 6.91829H10.0417C10.3346 6.91829 10.5815 7.01866 10.7822 7.2194C10.983 7.42013 11.0833 7.66699 11.0833 7.95996H16.2917C16.5846 7.95996 16.8315 8.06032 17.0322 8.26106C17.233 8.4618 17.3333 8.70594 17.3333 8.99348C17.3333 9.28103 17.233 9.52788 17.0322 9.73404C16.8315 9.94021 16.5846 10.0433 16.2917 10.0433ZM10.0417 7.95996H7.95832V10.0433H10.0417V7.95996ZM16.2917 3.79329H15.25C15.25 4.07541 15.1469 4.31955 14.9407 4.52571C14.7346 4.73187 14.4904 4.83496 14.2083 4.83496H12.125C11.832 4.83496 11.5852 4.73187 11.3844 4.52571C11.1837 4.31955 11.0833 4.07541 11.0833 3.79329H1.70832C1.41535 3.79329 1.1685 3.69021 0.967763 3.48404C0.767025 3.27788 0.666656 3.03103 0.666656 2.74348C0.666656 2.45594 0.767025 2.2118 0.967763 2.01106C1.1685 1.81032 1.41535 1.70996 1.70832 1.70996H11.0833C11.0833 1.41699 11.1837 1.17013 11.3844 0.969396C11.5852 0.768658 11.832 0.668289 12.125 0.668289H14.2083C14.5013 0.668289 14.7481 0.768658 14.9489 0.969396C15.1496 1.17013 15.25 1.41699 15.25 1.70996H16.2917C16.5846 1.70996 16.8315 1.81032 17.0322 2.01106C17.233 2.2118 17.3333 2.45594 17.3333 2.74348C17.3333 3.03103 17.233 3.27788 17.0322 3.48404C16.8315 3.69021 16.5846 3.79329 16.2917 3.79329ZM14.2083 1.70996H12.125V3.79329H14.2083V1.70996ZM1.70832 14.21H2.74999C2.74999 13.917 2.85036 13.6701 3.0511 13.4694C3.25183 13.2687 3.49869 13.1683 3.79166 13.1683H5.87499C6.15711 13.1683 6.40125 13.2687 6.60741 13.4694C6.81358 13.6701 6.91666 13.917 6.91666 14.21H16.2917C16.5846 14.21 16.8315 14.3103 17.0322 14.5111C17.233 14.7118 17.3333 14.9559 17.3333 15.2435C17.3333 15.531 17.2302 15.7779 17.0241 15.984C16.8179 16.1902 16.5738 16.2933 16.2917 16.2933H6.91666C6.91666 16.5863 6.81358 16.8331 6.60741 17.0338C6.40125 17.2346 6.15711 17.335 5.87499 17.335H3.79166C3.49869 17.335 3.25183 17.2319 3.0511 17.0257C2.85036 16.8195 2.74999 16.5754 2.74999 16.2933H1.70832C1.41535 16.2933 1.1685 16.1902 0.967763 15.984C0.767025 15.7779 0.666656 15.531 0.666656 15.2435C0.666656 14.9559 0.767025 14.7118 0.967763 14.5111C1.1685 14.3103 1.41535 14.21 1.70832 14.21ZM3.79166 16.2933H5.87499V14.21H3.79166V16.2933Z"
                fill="#ABA7AF"
              />
            </svg>
          </button>

          <ul className={styles.content}>
            {fileTypes.map(item => (
              <li
                onClick={() => onChangeFilter(item.id)}
                className={filters.includes(item.id) ? styles.active : ''}
                key={item.id}>
                <img src={item.icon} alt={item.id} loading="lazy" />
                <span>{item.type}</span>
              </li>
            ))}
          </ul>
        </div>
      </div>
    </article>
  )
}

export default ExpedienteHeader
